---
layout: post
title: Upgrading solr server from 6.6.0 to 7.3.1
date: 2018-06-13 17:36:30.000000000 +01:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- code
- Technology
tags:
- 6.6.0
- '7.3'
- 7.3.1
- Apache
- Moodle
- solr
- upgrade
meta:
  _wpas_done_all: '1'
  _jetpack_related_posts_cache: a:1:{s:32:"8f6677c9d6b0f903e98ad32ec61f8deb";a:2:{s:7:"expires";i:1560409700;s:7:"payload";a:3:{i:0;a:1:{s:2:"id";i:2715;}i:1;a:1:{s:2:"id";i:945;}i:2;a:1:{s:2:"id";i:678;}}}}
  _wpas_skip_5760912: '1'
  _wpas_skip_7785584: '1'
  _wpas_skip_20389018: '1'
  _wpas_skip_17253760: '1'
  _wpcom_is_markdown: '1'
  _thumbnail_id: '3059'
  _edit_last: '1'
  _publicize_twitter_user: "@cullaloe"
author:
  login: admin
  email: admin@cullaloe.net
  display_name: Nick
  first_name: Nick
  last_name: Hood
permalink: "/blog/2018/06/13/upgrading-solr-server-from-6-6-0-to-7-3-1/"
---
<p>I use Apache's <a href="http://lucene.apache.org/solr/">Solr</a>Â to provide a global search facility on Moodle. Now that my courses have ended for the summer, it's time to bite the bullet and upgrade the Solr server software from version 6.6.0 which I installed last year, to the current 7.3.1. This turned out to be more straightforward than I feared, and did not require me to touch the PHP solr module that I had to compile from source when I installed it the first time. Here are the steps:</p>
<pre># cd /opt
# wget http://apache.mirrors.nublue.co.uk/lucene/solr/7.3.1/solr-7.3.1.tgz
# tar zxvf solr-7.3.1.tgz
# cp solr-7.3.1/bin/install_solr_service.sh .
# rm -rf solr-7.3.1
# ./install_solr_service.sh solr-7.3.1.tgz -f</pre>
<p>Notice the -f flag which tells the script to upgrade an existing installation. The script stops the currently running instance, extracts the new code and starts the instance. A quick check of the admin interface on port 8983 shows the new code running OK, the cores intact, and the client service on Moodle nominal.</p>
<p><em><strong>EDIT:</strong> At present (June 2018) <a href="https://docs.moodle.org/35/en/Global_search#The_Solr_server">Solr 7 is not supported on Moodle 35</a>. The latest version of the Solr server that works with Moodle 35 is 6.6.4: the instructions above will install Solr 7. </em></p>
<p><em>If you want global search to work with Moodle 35, replace "7.3.1" with "6.6.4" and fetch the code using wget from the Apache archive at <a href="http://archive.apache.org/dist/lucene/solr/6.6.4/solr-6.6.4.tgz">http://archive.apache.org/dist/lucene/solr/6.6.4/solr-6.6.4.tgz</a>.</em></p>
